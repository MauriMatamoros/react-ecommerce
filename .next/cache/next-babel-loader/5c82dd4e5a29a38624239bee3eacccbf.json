{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/mmatamoros/Documents/react-reserve/pages/create.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState } from 'react';\nimport axios from 'axios';\nimport { Form, Input, TextArea, Button, Image, Message, Header, Icon } from 'semantic-ui-react';\nimport baseUrl from '../utils/baseUrl';\n\nconst CreateProduct = () => {\n  const INITIAL_PRODUCT = {\n    name: '',\n    description: '',\n    price: '',\n    media: ''\n  };\n  const {\n    0: product,\n    1: setProduct\n  } = useState(INITIAL_PRODUCT);\n  const {\n    0: mediaPreview,\n    1: setMediaPreview\n  } = useState('');\n  const {\n    0: success,\n    1: setSuccess\n  } = useState(false);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n\n  const handleChange = e => {\n    const {\n      name,\n      value,\n      files\n    } = e.target;\n\n    if (name === 'media') {\n      setProduct(prevState => _objectSpread({}, prevState, {\n        media: files[0]\n      }));\n      setMediaPreview(window.URL.createObjectURL(files[0]));\n    } else {\n      setProduct(prevState => _objectSpread({}, prevState, {\n        [name]: value\n      }));\n    }\n  }; //refactor image upload to the server\n\n\n  const handleImageUpload = async () => {\n    const data = new FormData();\n    data.append('file', product.media);\n    data.append('upload_preset', 'reactreserve');\n    data.append('cloud_name', 'mmatamoros');\n    const {\n      data: {\n        url: mediaUrl\n      }\n    } = await axios.post(process.env.CLOUDINARY_URL, data);\n    return mediaUrl;\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    const mediaUrl = await handleImageUpload();\n    const url = `${baseUrl}/api/product`;\n    const {\n      name,\n      price,\n      description\n    } = product;\n    const payload = {\n      name,\n      price,\n      description,\n      mediaUrl\n    };\n    const {\n      data\n    } = await axios.post(url, payload);\n    console.log({\n      data\n    });\n    setLoading(false);\n    setProduct(INITIAL_PRODUCT);\n    setSuccess(true);\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Header, {\n    as: \"h2\",\n    block: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, __jsx(Icon, {\n    name: \"add\",\n    color: \"orange\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }), \"Create New Product\"), __jsx(Form, {\n    loading: loading,\n    onSubmit: handleSubmit,\n    success: success,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }, __jsx(Message, {\n    success: true,\n    icon: \"check\",\n    header: \"Success!\",\n    content: \"Your product has been posted.\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }), __jsx(Form.Group, {\n    widths: \"equal\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, __jsx(Form.Field, {\n    control: Input,\n    name: \"name\",\n    label: \"Name\",\n    placeholder: \"Name\",\n    type: \"text\",\n    onChange: handleChange,\n    value: product.name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }), __jsx(Form.Field, {\n    control: Input,\n    name: \"price\",\n    label: \"Price\",\n    placeholder: \"Price\",\n    type: \"text\",\n    min: \"0.00\",\n    step: \"0.01\",\n    type: \"number\",\n    onChange: handleChange,\n    value: product.price,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }), __jsx(Form.Field, {\n    control: Input,\n    name: \"media\",\n    label: \"Media\",\n    content: \"Select Image\",\n    type: \"file\",\n    accept: \"image/*\",\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  })), __jsx(Image, {\n    src: mediaPreview,\n    rounded: true,\n    centered: true,\n    size: \"small\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }), __jsx(Form.Field, {\n    control: TextArea,\n    name: \"description\",\n    label: \"Description\",\n    placeholder: \"Description\",\n    type: \"text\",\n    onChange: handleChange,\n    value: product.description,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }), __jsx(Form.Field, {\n    control: Button,\n    color: \"blue\",\n    icon: \"pencil alternate\",\n    content: \"Submit\",\n    type: \"submit\",\n    disabled: loading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  })));\n};\n\nexport default CreateProduct;","map":{"version":3,"sources":["/Users/mmatamoros/Documents/react-reserve/pages/create.js"],"names":["useState","axios","Form","Input","TextArea","Button","Image","Message","Header","Icon","baseUrl","CreateProduct","INITIAL_PRODUCT","name","description","price","media","product","setProduct","mediaPreview","setMediaPreview","success","setSuccess","loading","setLoading","handleChange","e","value","files","target","prevState","window","URL","createObjectURL","handleImageUpload","data","FormData","append","url","mediaUrl","post","process","env","CLOUDINARY_URL","handleSubmit","preventDefault","payload","console","log"],"mappings":"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","sourcesContent":["import { useState } from 'react'\nimport axios from 'axios'\nimport {\n\tForm,\n\tInput,\n\tTextArea,\n\tButton,\n\tImage,\n\tMessage,\n\tHeader,\n\tIcon\n} from 'semantic-ui-react'\n\nimport baseUrl from '../utils/baseUrl'\n\nconst CreateProduct = () => {\n\tconst INITIAL_PRODUCT = {\n\t\tname: '',\n\t\tdescription: '',\n\t\tprice: '',\n\t\tmedia: ''\n\t}\n\tconst [product, setProduct] = useState(INITIAL_PRODUCT)\n\tconst [mediaPreview, setMediaPreview] = useState('')\n\tconst [success, setSuccess] = useState(false)\n\tconst [loading, setLoading] = useState(false)\n\n\tconst handleChange = (e) => {\n\t\tconst { name, value, files } = e.target\n\t\tif (name === 'media') {\n\t\t\tsetProduct((prevState) => ({ ...prevState, media: files[0] }))\n\t\t\tsetMediaPreview(window.URL.createObjectURL(files[0]))\n\t\t} else {\n\t\t\tsetProduct((prevState) => ({\n\t\t\t\t...prevState,\n\t\t\t\t[name]: value\n\t\t\t}))\n\t\t}\n\t}\n\t//refactor image upload to the server\n\tconst handleImageUpload = async () => {\n\t\tconst data = new FormData()\n\t\tdata.append('file', product.media)\n\t\tdata.append('upload_preset', 'reactreserve')\n\t\tdata.append('cloud_name', 'mmatamoros')\n\t\tconst {\n\t\t\tdata: { url: mediaUrl }\n\t\t} = await axios.post(process.env.CLOUDINARY_URL, data)\n\t\treturn mediaUrl\n\t}\n\n\tconst handleSubmit = async (e) => {\n\t\te.preventDefault()\n\t\tsetLoading(true)\n\t\tconst mediaUrl = await handleImageUpload()\n\t\tconst url = `${baseUrl}/api/product`\n\t\tconst { name, price, description } = product\n\t\tconst payload = { name, price, description, mediaUrl }\n\t\tconst { data } = await axios.post(url, payload)\n\t\tconsole.log({ data })\n\t\tsetLoading(false)\n\t\tsetProduct(INITIAL_PRODUCT)\n\t\tsetSuccess(true)\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<Header as='h2' block>\n\t\t\t\t<Icon name='add' color='orange' />\n\t\t\t\tCreate New Product\n\t\t\t</Header>\n\t\t\t<Form loading={loading} onSubmit={handleSubmit} success={success}>\n\t\t\t\t<Message\n\t\t\t\t\tsuccess\n\t\t\t\t\ticon='check'\n\t\t\t\t\theader='Success!'\n\t\t\t\t\tcontent='Your product has been posted.'\n\t\t\t\t/>\n\t\t\t\t<Form.Group widths='equal'>\n\t\t\t\t\t<Form.Field\n\t\t\t\t\t\tcontrol={Input}\n\t\t\t\t\t\tname='name'\n\t\t\t\t\t\tlabel='Name'\n\t\t\t\t\t\tplaceholder='Name'\n\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\tvalue={product.name}\n\t\t\t\t\t/>\n\t\t\t\t\t<Form.Field\n\t\t\t\t\t\tcontrol={Input}\n\t\t\t\t\t\tname='price'\n\t\t\t\t\t\tlabel='Price'\n\t\t\t\t\t\tplaceholder='Price'\n\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\tmin='0.00'\n\t\t\t\t\t\tstep='0.01'\n\t\t\t\t\t\ttype='number'\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\tvalue={product.price}\n\t\t\t\t\t/>\n\t\t\t\t\t<Form.Field\n\t\t\t\t\t\tcontrol={Input}\n\t\t\t\t\t\tname='media'\n\t\t\t\t\t\tlabel='Media'\n\t\t\t\t\t\tcontent='Select Image'\n\t\t\t\t\t\ttype='file'\n\t\t\t\t\t\taccept='image/*'\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t/>\n\t\t\t\t</Form.Group>\n\t\t\t\t<Image src={mediaPreview} rounded centered size='small' />\n\t\t\t\t<Form.Field\n\t\t\t\t\tcontrol={TextArea}\n\t\t\t\t\tname='description'\n\t\t\t\t\tlabel='Description'\n\t\t\t\t\tplaceholder='Description'\n\t\t\t\t\ttype='text'\n\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\tvalue={product.description}\n\t\t\t\t/>\n\t\t\t\t<Form.Field\n\t\t\t\t\tcontrol={Button}\n\t\t\t\t\tcolor='blue'\n\t\t\t\t\ticon='pencil alternate'\n\t\t\t\t\tcontent='Submit'\n\t\t\t\t\ttype='submit'\n\t\t\t\t\tdisabled={loading}\n\t\t\t\t/>\n\t\t\t</Form>\n\t\t</>\n\t)\n}\n\nexport default CreateProduct\n"]},"metadata":{},"sourceType":"module"}